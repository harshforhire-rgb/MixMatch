<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MixMatched - Build Community</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: { DEFAULT: '#EA580C', dark: '#C2410C' },
                        dark: { DEFAULT: '#29150F', secondary: '#3D405B' },
                        light: '#FFF7ED',
                        accent: '#F2CC8F',
                        green: '#81B29A',
                    },
                    fontFamily: { sans: ['DM Sans', 'sans-serif'] },
                }
            }
        }
    </script>
    <style>
        html {
            scroll-behavior: smooth;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Hide scrollbar for clean modal */
        .no-scroll {
            overflow: hidden;
        }
    </style>
</head>
<body class="font-sans antialiased text-gray-700 bg-white">

    <nav class="fixed w-full z-50 bg-white/95 backdrop-blur-sm shadow-sm transition-all duration-300" id="navbar">
        <div class="container mx-auto px-6 h-20 flex items-center justify-between">
            <a href="#" onclick="showView('landing')" class="flex items-center gap-2">
                <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center text-white text-xl">
                    <i class="ph-bold ph-users-three"></i>
                </div>
                <div class="leading-tight">
                    <span class="block text-xl font-bold text-dark tracking-tight">MixMatched</span>
                    <small class="text-xs text-gray-500 uppercase tracking-widest font-bold">Community Club</small>
                </div>
            </a>
            <div class="hidden lg:flex items-center gap-8">
                <a href="#about" class="text-gray-600 hover:text-primary font-medium text-sm uppercase">Process</a>
                <a href="#membership" class="text-gray-600 hover:text-primary font-medium text-sm uppercase">Why Join</a>
                <button onclick="toggleAuthModal()" class="px-6 py-2 bg-transparent border-2 border-primary text-primary rounded-full font-bold hover:bg-primary hover:text-white transition-all">
                    Member Login
                </button>
            </div>
        </div>
    </nav>

    <div id="view-landing">
        <section class="relative bg-dark pt-32 pb-20 lg:pt-40 min-h-[85vh] flex items-center overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-primary/20 to-dark/90 z-0"></div>
            <div class="container mx-auto px-6 relative z-10">
                <div class="grid lg:grid-cols-2 gap-12 items-center">
                    <div class="text-center lg:text-left">
                        <h2 class="text-primary font-bold text-xl uppercase tracking-widest mb-2">Welcome to the Club</h2>
                        <h1 class="text-5xl lg:text-7xl font-bold text-white mb-8 leading-tight">
                            Build real<br><span class="text-accent">Connections.</span>
                        </h1>
                        <button onclick="toggleAuthModal()" class="px-8 py-3 bg-primary text-white rounded-full font-bold hover:bg-primary-dark transition-all shadow-lg ring-4 ring-primary/30">
                            Start Matching
                        </button>
                    </div>
                    <div class="relative rounded-2xl overflow-hidden shadow-2xl border-4 border-white/10 rotate-2">
                        <img src="https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&q=80&w=1000" class="w-full opacity-80">
                    </div>
                </div>
            </div>
            <div class="absolute bottom-0 left-0 w-full leading-0"><svg viewBox="0 0 1440 320" class="fill-white"><path fill-opacity="1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,224C672,245,768,267,864,261.3C960,256,1056,224,1152,202.7C1248,181,1344,171,1392,165.3L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg></div>
        </section>
        
        <footer class="bg-white py-12 text-center text-gray-500 text-sm">
            <p>&copy; 2024 MixMatched Inc. Join the community.</p>
        </footer>
    </div>

    <div id="view-onboarding" class="hidden min-h-screen bg-light pt-28 pb-12">
        <div class="container mx-auto px-6 max-w-4xl">
            
            <div class="flex justify-between mb-8 relative">
                <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-10 rounded"></div>
                <div id="progress-line" class="absolute top-1/2 left-0 w-0 h-1 bg-primary -z-10 rounded transition-all duration-500"></div>
                
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center font-bold relative z-10 step-indicator">1</div>
                <div class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold relative z-10 step-indicator">2</div>
                <div class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold relative z-10 step-indicator">3</div>
                <div class="w-10 h-10 bg-gray-200 text-gray-500 rounded-full flex items-center justify-center font-bold relative z-10 step-indicator">4</div>
            </div>

            <form id="preferences-form" onsubmit="event.preventDefault(); submitPreferences();">
                
                <div class="step-content fade-in bg-white p-8 rounded-3xl shadow-card" id="step-1">
                    <h2 class="text-2xl font-bold text-dark mb-2">Where are you located?</h2>
                    <p class="text-gray-500 mb-6">We'll find groups near you.</p>

                    <div class="flex gap-4 mb-6 border-b border-gray-100">
                        <button type="button" onclick="toggleLocTab('zip')" id="tab-zip" class="pb-2 border-b-2 border-primary font-bold text-primary">Zip & Radius</button>
                        <button type="button" onclick="toggleLocTab('city')" id="tab-city" class="pb-2 border-b-2 border-transparent text-gray-400 hover:text-dark">Manual Search</button>
                    </div>

                    <div id="loc-content-zip">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Zip Code</label>
                                <input type="text" id="zipInput" placeholder="e.g. 10001" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-1">Radius (Miles)</label>
                                <select id="radiusInput" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20" onchange="simulateCityFetch()">
                                    <option value="5">5 Miles</option>
                                    <option value="15">15 Miles</option>
                                    <option value="50">50 Miles</option>
                                    <option value="250">250 Miles</option>
                                </select>
                            </div>
                        </div>
                        <div id="radius-results" class="mt-4 p-4 bg-green-50 text-green-800 rounded-xl text-sm hidden">
                            <i class="ph-bold ph-map-pin"></i> Found <span class="font-bold">12 cities</span> in this range including New York, Jersey City, Hoboken...
                        </div>
                    </div>

                    <div id="loc-content-city" class="hidden">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Search Cities (Max 5)</label>
                        <input type="text" placeholder="Type a city name..." class="w-full p-4 bg-gray-50 rounded-xl mb-2">
                        <div class="flex flex-wrap gap-2">
                            <span class="px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-bold flex items-center gap-2">San Francisco <button type="button"><i class="ph-bold ph-x"></i></button></span>
                            <span class="px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-bold flex items-center gap-2">Oakland <button type="button"><i class="ph-bold ph-x"></i></button></span>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-end">
                        <button type="button" onclick="nextStep(2)" class="px-8 py-3 bg-dark text-white rounded-full font-bold hover:bg-primary transition-all">Next Step</button>
                    </div>
                </div>

                <div class="step-content fade-in hidden bg-white p-8 rounded-3xl shadow-card" id="step-2">
                    <h2 class="text-2xl font-bold text-dark mb-2">Budget & Vibe</h2>
                    <p class="text-gray-500 mb-6">Help us curate the right activity.</p>

                    <div class="mb-8">
                        <label class="block text-sm font-bold text-gray-700 mb-3">Willingness to Pay (Per Event)</label>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <label class="cursor-pointer">
                                <input type="radio" name="budget" value="low" class="peer sr-only" onchange="updateSubActivities()">
                                <div class="p-4 rounded-xl border-2 border-gray-100 text-center peer-checked:border-primary peer-checked:bg-primary/5 hover:bg-gray-50 transition-all">
                                    <span class="block font-bold text-lg text-dark">&lt;$20</span>
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="budget" value="mid" class="peer sr-only" onchange="updateSubActivities()">
                                <div class="p-4 rounded-xl border-2 border-gray-100 text-center peer-checked:border-primary peer-checked:bg-primary/5 hover:bg-gray-50 transition-all">
                                    <span class="block font-bold text-lg text-dark">$20-40</span>
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="budget" value="high" class="peer sr-only" onchange="updateSubActivities()">
                                <div class="p-4 rounded-xl border-2 border-gray-100 text-center peer-checked:border-primary peer-checked:bg-primary/5 hover:bg-gray-50 transition-all">
                                    <span class="block font-bold text-lg text-dark">$40-80</span>
                                </div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="budget" value="lux" class="peer sr-only" onchange="updateSubActivities()">
                                <div class="p-4 rounded-xl border-2 border-gray-100 text-center peer-checked:border-primary peer-checked:bg-primary/5 hover:bg-gray-50 transition-all">
                                    <span class="block font-bold text-lg text-dark">$80+</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="mb-8">
                        <label class="block text-sm font-bold text-gray-700 mb-3">Interests (Select all that apply)</label>
                        <div class="flex flex-wrap gap-4">
                            <label class="cursor-pointer inline-flex items-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-full has-[:checked]:border-primary has-[:checked]:bg-primary has-[:checked]:text-white transition-all">
                                <input type="checkbox" name="interest" value="Indoor" class="sr-only" onchange="updateSubActivities()">
                                <i class="ph-bold ph-armchair"></i> Indoor
                            </label>
                            <label class="cursor-pointer inline-flex items-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-full has-[:checked]:border-primary has-[:checked]:bg-primary has-[:checked]:text-white transition-all">
                                <input type="checkbox" name="interest" value="Outdoor" class="sr-only" onchange="updateSubActivities()">
                                <i class="ph-bold ph-tree"></i> Outdoor
                            </label>
                            <label class="cursor-pointer inline-flex items-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-full has-[:checked]:border-primary has-[:checked]:bg-primary has-[:checked]:text-white transition-all">
                                <input type="checkbox" name="interest" value="Food" id="check-food" class="sr-only" onchange="updateSubActivities()">
                                <i class="ph-bold ph-pizza"></i> Food
                            </label>
                            <label class="cursor-pointer inline-flex items-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-full has-[:checked]:border-primary has-[:checked]:bg-primary has-[:checked]:text-white transition-all">
                                <input type="checkbox" name="interest" value="Recreation" class="sr-only" onchange="updateSubActivities()">
                                <i class="ph-bold ph-game-controller"></i> Recreation
                            </label>
                            <label class="cursor-pointer inline-flex items-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-full has-[:checked]:border-primary has-[:checked]:bg-primary has-[:checked]:text-white transition-all">
                                <input type="checkbox" name="interest" value="Education" class="sr-only" onchange="updateSubActivities()">
                                <i class="ph-bold ph-book"></i> Educational
                            </label>
                        </div>
                    </div>

                    <div id="dynamic-activities" class="p-6 bg-accent/10 rounded-xl hidden">
                        <h4 class="font-bold text-dark mb-2 text-sm uppercase tracking-wide">Suggested For You:</h4>
                        <div id="suggestions-list" class="flex flex-wrap gap-2">
                            </div>
                    </div>

                    <div class="mt-8 flex justify-between">
                        <button type="button" onclick="nextStep(1)" class="text-gray-500 hover:text-dark font-bold">Back</button>
                        <button type="button" onclick="nextStep(3)" class="px-8 py-3 bg-dark text-white rounded-full font-bold hover:bg-primary transition-all">Next Step</button>
                    </div>
                </div>

                <div class="step-content fade-in hidden bg-white p-8 rounded-3xl shadow-card" id="step-3">
                    <h2 class="text-2xl font-bold text-dark mb-2">Final Details</h2>
                    <p class="text-gray-500 mb-6">Almost there.</p>

                    <div id="dietary-section" class="mb-8 hidden">
                        <div class="p-4 border-l-4 border-primary bg-primary/5 rounded-r-xl">
                            <label class="block text-sm font-bold text-gray-700 mb-3"><i class="ph-fill ph-fork-knife text-primary"></i> Since you chose Food, any restrictions?</label>
                            <select class="w-full p-4 bg-white border border-gray-200 rounded-xl focus:outline-none">
                                <option>No Preference</option>
                                <option>Vegetarian</option>
                                <option>Vegan</option>
                                <option>Pescatarian</option>
                                <option>Kosher</option>
                                <option>Halal</option>
                                <option>Gluten Free</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-8">
                        <label class="block text-sm font-bold text-gray-700 mb-3">Group Preferences</label>
                        <div class="space-y-3">
                            <label class="flex items-center gap-3 p-3 border border-gray-100 rounded-xl cursor-pointer hover:bg-gray-50">
                                <input type="radio" name="mingle" value="balanced" checked class="text-primary focus:ring-primary">
                                <div>
                                    <span class="block font-bold text-dark">Gender Balanced</span>
                                    <span class="text-xs text-gray-500">Mix of men and women</span>
                                </div>
                            </label>
                            <label class="flex items-center gap-3 p-3 border border-gray-100 rounded-xl cursor-pointer hover:bg-gray-50">
                                <input type="radio" name="mingle" value="same_gender" class="text-primary focus:ring-primary">
                                <div>
                                    <span class="block font-bold text-dark">Same Gender Only</span>
                                    <span class="text-xs text-gray-500">Girls night / Guys night out</span>
                                </div>
                            </label>
                            <label class="flex items-center gap-3 p-3 border border-gray-100 rounded-xl cursor-pointer hover:bg-gray-50">
                                <input type="radio" name="mingle" value="same_age" class="text-primary focus:ring-primary">
                                <div>
                                    <span class="block font-bold text-dark">Same Age Group (+/- 5 Years)</span>
                                    <span class="text-xs text-gray-500">Strictly people my age</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-between">
                        <button type="button" onclick="nextStep(2)" class="text-gray-500 hover:text-dark font-bold">Back</button>
                        <button type="button" onclick="submitPreferences()" class="px-8 py-3 bg-dark text-white rounded-full font-bold hover:bg-primary transition-all">Submit Profile</button>
                    </div>
                </div>

                <div class="step-content fade-in hidden bg-white p-8 rounded-3xl shadow-card text-center" id="step-4">
                    <div class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6 text-3xl">
                        <i class="ph-fill ph-check"></i>
                    </div>
                    <h2 class="text-3xl font-bold text-dark mb-4">Profile Created!</h2>
                    <p class="text-gray-600 mb-8 max-w-md mx-auto">
                        We are currently looking for 5 other people who match your vibe, budget, and location.
                    </p>
                    
                    <div class="bg-gray-50 p-6 rounded-2xl max-w-md mx-auto text-left mb-8">
                        <h4 class="font-bold text-dark mb-4 border-b pb-2">Your Matching Criteria</h4>
                        <div class="flex items-center gap-3 mb-2">
                            <i class="ph-fill ph-wallet text-primary"></i> <span id="dash-budget">Budget: $20-40</span>
                        </div>
                        <div class="flex items-center gap-3 mb-2">
                            <i class="ph-fill ph-map-pin text-primary"></i> <span id="dash-loc">Searching in 15 mile radius</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <i class="ph-fill ph-users text-primary"></i> <span id="dash-group">Waiting for group formation...</span>
                        </div>
                    </div>

                    <button type="button" onclick="alert('Demo: Contact sharing will be enabled once 6 people are matched!')" class="text-primary font-bold hover:underline">How does contact sharing work?</button>
                </div>

            </form>
        </div>
    </div>

<div id="view-group" class="hidden min-h-screen bg-light pt-28 pb-12">
        <div class="container mx-auto px-6 max-w-5xl">
            
            <div class="text-center mb-12 fade-in">
                <span class="px-4 py-2 bg-primary/10 text-primary rounded-full text-sm font-bold uppercase tracking-widest">Match Found</span>
                <h2 class="text-4xl font-bold text-dark mt-4">Meet Your Crew</h2>
                <p class="text-gray-600 mt-2">We found 5 others who match your vibe and budget.</p>
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                
                <div class="lg:col-span-1 fade-in">
                    <div class="bg-white p-6 rounded-3xl shadow-card h-full border-t-8 border-primary relative overflow-hidden">
                        <h3 class="text-gray-400 font-bold text-xs uppercase tracking-widest mb-2">Selected Activity</h3>
                        <h2 class="text-2xl font-bold text-dark mb-4" id="match-activity-title">Sunset Hiking</h2>
                        
                        <div class="space-y-4">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center text-primary"><i class="ph-bold ph-calendar"></i></div>
                                <div>
                                    <p class="text-xs text-gray-500 font-bold uppercase">Date</p>
                                    <p class="font-bold text-dark">Sat, Mar 24 @ 5:00 PM</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center text-primary"><i class="ph-bold ph-map-pin"></i></div>
                                <div>
                                    <p class="text-xs text-gray-500 font-bold uppercase">Location</p>
                                    <p class="font-bold text-dark">West Ridge Trailhead</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gray-50 rounded-full flex items-center justify-center text-primary"><i class="ph-bold ph-wallet"></i></div>
                                <div>
                                    <p class="text-xs text-gray-500 font-bold uppercase">Est. Cost</p>
                                    <p class="font-bold text-dark">$15 (Parking)</p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-8 pt-6 border-t border-gray-100">
                            <button onclick="endEventDemo()" class="w-full py-3 bg-dark text-white rounded-xl font-bold hover:bg-gray-800 transition-all text-sm">
                                Simulate: Event Finished
                            </button>
                            <p class="text-center text-xs text-gray-400 mt-2">(Click this to see Contact Sharing)</p>
                        </div>
                    </div>
                </div>

                <div class="lg:col-span-2">
                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="members-grid">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div id="view-contact" class="hidden min-h-screen bg-white pt-28 pb-12">
        <div class="container mx-auto px-6 max-w-2xl">
            
            <div class="text-center mb-8 fade-in">
                <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl">
                    <i class="ph-bold ph-thumbs-up"></i>
                </div>
                <h2 class="text-3xl font-bold text-dark">How was it?</h2>
                <p class="text-gray-600">Select the people you'd like to stay in touch with. <br>Your details are only shared if the feeling is mutual.</p>
            </div>

            <div class="bg-gray-50 rounded-3xl p-8 shadow-inner" id="contact-list">
                </div>

            <div class="mt-8 flex justify-center">
                <button onclick="submitContacts()" class="px-8 py-3 bg-primary text-white rounded-full font-bold hover:bg-primary-dark transition-all shadow-lg">
                    Confirm Matches
                </button>
            </div>

        </div>
    </div>


    <div id="auth-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-dark/80 backdrop-blur-sm" onclick="toggleAuthModal()"></div>
        
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden animate-[fadeIn_0.3s_ease-out]">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-dark" id="auth-title">Welcome!</h3>
                    <button onclick="toggleAuthModal()" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-red-100 hover:text-red-500 flex items-center justify-center transition-colors">
                        <i class="ph-bold ph-x"></i>
                    </button>
                </div>

                <div id="auth-forms">
                    
                    <form id="form-login" class="space-y-4">
                        <input type="email" placeholder="Email Address" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                        <input type="password" placeholder="Password" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                        <button type="button" onclick="loginDemo()" class="w-full py-4 bg-primary text-white font-bold rounded-xl hover:bg-primary-dark transition-all">Log In</button>
                        <p class="text-center text-gray-500 text-sm">
                            New here? <button type="button" onclick="switchAuthMode('signup')" class="text-primary font-bold hover:underline">Create Account</button>
                        </p>
                    </form>

                    <form id="form-signup" class="space-y-4 hidden">
                        <input type="text" id="signup-name" placeholder="Full Name" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                        <input type="email" id="signup-email" placeholder="Email Address" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">

                        <input type="password" id="signup-password" placeholder="Create a Password" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-gray-400 ml-2">Date of Birth</label>
                                <input type="date" id="signup-dob" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-400 ml-2">Gender</label>
                                <select id="signup-gender" class="w-full p-4 bg-gray-50 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/20">
                                    <option>Male</option>
                                    <option>Female</option>
                                    <option>Other</option>
                                </select>
                            </div>
                        </div>
                        <button type="button" onclick="signupDemo()" class="w-full py-4 bg-primary text-white font-bold rounded-xl hover:bg-primary-dark transition-all">Create Profile</button>
                        <p class="text-center text-gray-500 text-sm">
                            Have an account? <button type="button" onclick="switchAuthMode('login')" class="text-primary font-bold hover:underline">Log In</button>
                        </p>
                    </form>

                </div>
            </div>
        </div>
    </div>
    <script>
        // ==========================================
        // 1. SUPABASE CONFIGURATION
        // ==========================================
        const SUPABASE_URL = 'https://udfqdwbvjyghvrmifbdm.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_kp35QwhZVVPvJ_s3wYBlyA_P3Nq50qL';

        // We use a distinct name 'supabaseClient' to avoid conflict with the library 'supabase'
        let supabaseClient;

        try {
            // Check if the library loaded from the CDN
            if (typeof supabase !== 'undefined') {
                supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log("Supabase connected successfully.");
            } else {
                console.warn("Supabase library not loaded. Check your internet connection or CDN link.");
            }
        } catch (err) {
            console.error("Initialization error:", err);
        }

        // ==========================================
        // 2. VIEW & NAVIGATION LOGIC
        // ==========================================
        function showView(viewName) {
            // Hide all views
            ['landing', 'onboarding', 'group', 'contact'].forEach(v => {
                const el = document.getElementById(`view-${v}`);
                if (el) el.classList.add('hidden');
            });

            // Show selected view
            const selected = document.getElementById(`view-${viewName}`);
            if (selected) {
                selected.classList.remove('hidden');
                window.scrollTo(0, 0);
            }
        }

        function toggleAuthModal() {
            const modal = document.getElementById('auth-modal');
            const body = document.body;

            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                body.classList.add('no-scroll');
            } else {
                modal.classList.add('hidden');
                body.classList.remove('no-scroll');
            }
        }

        function switchAuthMode(mode) {
            const loginForm = document.getElementById('form-login');
            const signupForm = document.getElementById('form-signup');
            const title = document.getElementById('auth-title');

            if (mode === 'signup') {
                loginForm.classList.add('hidden');
                signupForm.classList.remove('hidden');
                title.innerText = "Create Account";
            } else {
                loginForm.classList.remove('hidden');
                signupForm.classList.add('hidden');
                title.innerText = "Welcome!";
            }
        }

        // ==========================================
        // 3. AUTHENTICATION LOGIC
        // ==========================================
        async function loginDemo() {
            const email = document.querySelector('#form-login input[type="email"]').value;
            const password = document.querySelector('#form-login input[type="password"]').value;

            if (supabaseClient) {
                // Real Login
                const { data, error } = await supabaseClient.auth.signInWithPassword({
                    email: email,
                    password: password,
                });

                if (error) {
                    alert("Login Error: " + error.message);
                } else {
                    console.log("Logged in:", data);
                    toggleAuthModal();
                    showView('onboarding');
                }
            } else {
                // Fallback (Offline/Demo Mode)
                console.log("Simulating login (Supabase not connected)");
                toggleAuthModal();
                showView('onboarding');
            }
        }

        async function signupDemo() {
            // 1. Get all values from the form
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value; // Now getting real input
            const name = document.getElementById('signup-name').value;
            const dob = document.getElementById('signup-dob').value;
            const gender = document.getElementById('signup-gender').value;

            if (!email || !password || !name) {
                alert("Please fill in all fields.");
                return;
            }

            if (supabaseClient) {
                // 2. Create the Auth User
                const { data, error } = await supabaseClient.auth.signUp({
                    email: email,
                    password: password,
                    // We can pass extra metadata here
                    options: {
                        data: {
                            full_name: name,
                            dob: dob,
                            gender: gender
                        }
                    }
                });

                if (error) {
                    alert("Signup Error: " + error.message);
                } else {
                    // 3. Insert into the 'profiles' table (Optional but recommended)
                    // Note: This requires the 'profiles' table to exist in your DB.
                    // If you just want to get Auth working, you can comment this block out.
                    const { error: profileError } = await supabaseClient
                        .from('profiles')
                        .insert([
                            {
                                id: data.user.id, // Links to Auth User
                                email: email,
                                full_name: name,
                                dob: dob || null,
                                gender: gender
                            }
                        ]);

                    if (profileError) {
                        console.error("Error saving profile details:", profileError);
                    }

                    alert("Account created! Please Log In.");
                    // Switch back to Login view so they can use their new password
                    switchAuthMode('login');
                }
            } else {
                // Fallback
                console.log("Simulating signup with password: " + password);
                toggleAuthModal();
                showView('onboarding');
            }
        }

        // ==========================================
        // 4. ONBOARDING WIZARD LOGIC
        // ==========================================
        let currentStep = 1;

        function nextStep(step) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`step-${step}`).classList.remove('hidden');

            const line = document.getElementById('progress-line');
            const indicators = document.querySelectorAll('.step-indicator');

            if (step === 1) line.style.width = "0%";
            if (step === 2) line.style.width = "33%";
            if (step === 3) line.style.width = "66%";
            if (step === 4) line.style.width = "100%";

            indicators.forEach((ind, index) => {
                if (index + 1 <= step) {
                    ind.classList.remove('bg-gray-200', 'text-gray-500');
                    ind.classList.add('bg-primary', 'text-white');
                } else {
                    ind.classList.add('bg-gray-200', 'text-gray-500');
                    ind.classList.remove('bg-primary', 'text-white');
                }
            });
            currentStep = step;
        }

        function toggleLocTab(type) {
            const zipContent = document.getElementById('loc-content-zip');
            const cityContent = document.getElementById('loc-content-city');
            const zipTab = document.getElementById('tab-zip');
            const cityTab = document.getElementById('tab-city');

            if (type === 'zip') {
                zipContent.classList.remove('hidden');
                cityContent.classList.add('hidden');
                zipTab.classList.add('border-primary', 'text-primary');
                cityTab.classList.remove('border-primary', 'text-primary');
            } else {
                zipContent.classList.add('hidden');
                cityContent.classList.remove('hidden');
                cityTab.classList.add('border-primary', 'text-primary');
                zipTab.classList.remove('border-primary', 'text-primary');
            }
        }

        function simulateCityFetch() {
            const resultBox = document.getElementById('radius-results');
            const radius = document.getElementById('radiusInput').value;
            resultBox.classList.remove('hidden');
            resultBox.innerHTML = `<i class="ph-bold ph-map-pin"></i> Found <span class="font-bold">${Math.floor(Math.random() * 20) + 5} cities</span> within ${radius} miles.`;
        }

        // ==========================================
        // 5. ACTIVITY & MATCHING LOGIC
        // ==========================================
        const activityMap = {
            'low': { 'Outdoor': ['Hiking', 'Park Picnic'], 'Indoor': ['Board Game Night', 'Mall Walk'], 'Food': ['Street Tacos', 'Coffee Meetup'] },
            'mid': { 'Outdoor': ['Kayaking', 'Minigolf'], 'Indoor': ['Museum Tour', 'Escape Room'], 'Food': ['Brunch', 'Casual Dining'] },
            'high': { 'Outdoor': ['Guided City Tour', 'Theme Park'], 'Indoor': ['Pottery Class', 'Concert'], 'Food': ['Fine Dining', 'Wine Tasting'] },
            'lux': { 'Outdoor': ['Yacht Rental', 'Private Retreat'], 'Indoor': ['VIP Theater', 'Spa Day'], 'Food': ['Michelin Star Dinner'] }
        };

        function updateSubActivities() {
            const budgetEls = document.getElementsByName('budget');
            let selectedBudget = 'low';
            for (let el of budgetEls) if (el.checked) selectedBudget = el.value;

            const interestEls = document.getElementsByName('interest');
            let selectedInterests = [];
            let foodSelected = false;

            for (let el of interestEls) {
                if (el.checked) {
                    selectedInterests.push(el.value);
                    if (el.value === 'Food') foodSelected = true;
                }
            }

            const dietSection = document.getElementById('dietary-section');
            if (foodSelected) dietSection.classList.remove('hidden');
            else dietSection.classList.add('hidden');

            const container = document.getElementById('dynamic-activities');
            const list = document.getElementById('suggestions-list');
            list.innerHTML = '';

            if (selectedInterests.length > 0) {
                container.classList.remove('hidden');
                selectedInterests.forEach(interest => {
                    if (activityMap[selectedBudget] && activityMap[selectedBudget][interest]) {
                        const activities = activityMap[selectedBudget][interest];
                        activities.forEach(act => {
                            const badge = document.createElement('span');
                            badge.className = "px-3 py-1 bg-white text-dark border border-gray-200 rounded-lg text-sm font-bold shadow-sm";
                            badge.innerText = act;
                            list.appendChild(badge);
                        });
                    }
                });
            } else {
                container.classList.add('hidden');
            }
        }

        // Mock Data for Match Logic
        const mockPodMembers = [
            { name: "Sarah J.", age: 27, job: "UX Designer", img: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=150&q=80" },
            { name: "Mike T.", age: 29, job: "Teacher", img: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=150&q=80" },
            { name: "Jessica L.", age: 26, job: "Nurse", img: "https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=150&q=80" },
            { name: "David R.", age: 30, job: "Engineer", img: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=150&q=80" },
            { name: "Alex K.", age: 28, job: "Chef", img: "https://images.unsplash.com/photo-1527980965255-d3b416303d12?auto=format&fit=crop&w=150&q=80" }
        ];

        function submitPreferences() {
            // Save to DB would go here
            nextStep(4);
            setTimeout(() => {
                renderGroup();
                showView('group');
            }, 2500);
        }

        function renderGroup() {
            const grid = document.getElementById('members-grid');
            grid.innerHTML = '';
            grid.innerHTML += `
                        <div class="bg-primary/5 border-2 border-primary border-dashed p-4 rounded-2xl flex flex-col items-center justify-center text-center">
                            <div class="w-20 h-20 bg-primary/20 rounded-full flex items-center justify-center text-primary mb-3">
                                <i class="ph-fill ph-user text-3xl"></i>
                            </div>
                            <h4 class="font-bold text-dark">You</h4>
                            <p class="text-xs text-gray-500">Ready to mingle</p>
                        </div>
                    `;
            mockPodMembers.forEach(member => {
                grid.innerHTML += `
                            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 text-center hover:shadow-md transition-shadow">
                                <img src="${member.img}" class="w-20 h-20 rounded-full mx-auto mb-3 object-cover border-2 border-white shadow-sm">
                                <h4 class="font-bold text-dark">${member.name}</h4>
                                <p class="text-xs text-gray-500 uppercase font-bold tracking-wide mb-1">${member.age} â€¢ ${member.job}</p>
                            </div>
                        `;
            });
        }

        function endEventDemo() {
            renderContactForm();
            showView('contact');
        }

        function renderContactForm() {
            const list = document.getElementById('contact-list');
            list.innerHTML = '';
            mockPodMembers.forEach((member, index) => {
                list.innerHTML += `
                            <div class="flex items-center justify-between p-4 bg-white rounded-xl mb-3 border border-gray-100">
                                <div class="flex items-center gap-4">
                                    <img src="${member.img}" class="w-12 h-12 rounded-full object-cover">
                                    <div>
                                        <h4 class="font-bold text-dark">${member.name}</h4>
                                        <p class="text-xs text-gray-500">Did you connect?</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="contact-${index}">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                                    <span class="ml-3 text-sm font-medium text-gray-900">Share</span>
                                </label>
                            </div>
                        `;
            });
        }

        function submitContacts() {
            alert("Great! If they check 'Share' for you too, you'll receive an email introduction.");
            showView('landing');
        }
    </script>
</body>
</html>
